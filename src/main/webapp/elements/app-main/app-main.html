<dom-module id="app-main">
    <style>
        paper-material {
            border-radius: 2px;
            height: 100%;
            padding: 16px 0px 16px 0px;
            width: calc(98.66% - 16px);
            margin: 16px auto;
            background: white;
        }

        #mainToolbar {
            box-shadow: 0 4px 5px 0 rgba(0, 0, 0, .14),
            0 2px 9px 1px rgba(0, 0, 0, .12),
            0 4px 2px -2px rgba(0, 0, 0, .2);
        }

        paper-menu iron-icon {
            margin-right: 33px;
            opacity: 0.54;
        }

        .paper-menu > .iron-selected {
            color: var(--default-primary-color);
        }


        paper-menu a {
            text-decoration: none;
            color: var(--menu-link-color);
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -ms-flex-direction: row;
            -webkit-flex-direction: row;
            flex-direction: row;
            -ms-flex-align: center;
            -webkit-align-items: center;
            align-items: center;
            font-family: 'Roboto', 'Noto', sans-serif;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            font-size: 14px;
            font-weight: 400;
            line-height: 24px;
            min-height: 40px;
            padding: 0px 16px;
        }

        #drawerToolbar {
            border-bottom: var(--drawer-toolbar-border-color);
            /*height: 120px;*/
        }

        #paperToggle {
            width: 45px;
            height: 45px;
            border: none;
            color: var(--drawer-menu-color);
            background-color: transparent;
            margin-right: 16px;
            padding: 8px;
        }
    </style>
    <template>

            <paper-header-panel main mode="standard">
                <paper-toolbar id="mainToolbar">

                    <paper-button on-tap="logout">Logout</paper-button>
                    <span class = "title">CT DPH Shape Grant</span>
                    <!--span> Ct DPH SHAPE </span-->


                    <paper-icon-button icon="home" on-tap="navigateHome"></paper-icon-button>
                    <paper-button on-tap="handleAdminPanel">Admin Panel</paper-button>
                    <paper-button on-tap="handleAccount">Account</paper-button>
                </paper-toolbar>
                <iron-pages attr-for-selected="data-route" selected="{{route}}">
                    <section data-route="home">
                        <paper-materials>
                            <app-dashboard id="dashboard"></app-dashboard>
                        </paper-material>
                    </section>

                    <section data-route="account">
                        <paper-material elevation="1">
                            <app-account></app-account>
                        </paper-material>
                    </section>

                    <section data-route="adminpanel">
                        <paper-material elevation="1">
                            <app-admin-panel></app-admin-panel>
                        </paper-material>
                    </section>

                    <section data-route="settings">
                        <paper-material elevation="1">
                            <h2 class="paper-font-display2">Contact</h2>

                            <p>This is the contact section</p>
                        </paper-material>
                    </section>

                </iron-pages>
 </template>
</dom-module>
<script>
    (function () {
        Polymer({
            is: 'app-main',
            properties: {
                route: {
                  type: String
                },
                role : {
                  type: String
                }
            },
            attached: function () {
                this.route = 'home';
            },
            _toggleDrawerPanel: function (evt) {
                this.$.paperDrawerPanel.togglePanel();
                var nVal = evt.target.parentElement.getAttributeNode('data-route').value;
                if (nVal == 'logout') {
                    appAuth.logout();
                    app.select = 'login';
                    evt.stopPropagation();
                }
            },
            menuSelect: function (e) {
                app.select = 'login';
                this.$.paperDrawerPanel.togglePanel();
                e.stopPropagation();
            },
            logout: function(e) {

            },
            handleAccount: function (e) {
                this.route = 'account';
            },
            handleAdminPanel: function (e) {
                this.route = 'adminpanel';
                var template = document.querySelector('template[is="dom-bind"]');
                document.querySelector('app-admin-add').setajaxOrgs();
                document.querySelector('app-admin-panel-user').setajax();
            },
            navigateHome: function (e) {
                this.route = 'home';
            },
            logout: function(){
                app.$.loginPage.logout();
            }
        });
    })();
</script>
<script>
var inactivityTime = function () {
    var t;
    window.onload = resetTimer;
    document.onmousemove = resetTimer;
    document.onkeypress = resetTimer;

    function logout() {
        alert("You have been logged out due to inactivity.")
        location.reload(true)
    }

    function resetTimer() {
        clearTimeout(t);
        t = setTimeout(logout, 900000)
    }
};
inactivityTime();
</script>
