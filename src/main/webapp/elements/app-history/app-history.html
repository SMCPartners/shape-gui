<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../elements.html">


<dom-module id="app-history">
    <style>
        .pms {
            @apply(--pm-style)
        };
        .child {
            order: 0;
            flex: 0 1 auto;
            align-self: center;
        };
        .parent {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-around;
            align-content: space-between;
            align-items: flex-start;
        };
        .parenttwo {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
            align-content: space-between;
            align-items: flex-start;
        };
        .header {
            font-size: 36px;
        };
        .modalHeader {
        align: center;
        };
        .modalSection {
        font-size: 20px;
        };
        .leader {
        border-color: black;
        };
        .double {
        flex: 2 2;
        };
        .single {
        flex: 1 1;
        };

        select[selected] {
        border: none;
        }
        select {
        height: 2.5em;
        font-size: 1em;
        background: transparent;
        border: none;
        }
        select[focused] {
        border: none;
        }

    </style>
    <template>
        <div class="pms">
            <div class="parent">
                <div class="child parent">
                    <label class="child" style="font: inherit; margin-left:0.5em;"><b>Measure:</b> </label>
                    <div class="child" style="box-shadow: 1px 1px 1px 1px lightgray; margin: 0 1em;">
                        <select id="selectMeasure" name="measure" style="font: inherit" on-change="loadMeasureData">
                          <option>Select Measure</option>
                            <template is="dom-repeat" restamp="true" selectedMeasures={{item}} items="{{measures}}">
                                <option style="font: inherit" value={{item.id}}>
                                    NQF <span>{{item.nqfId}}</span> <span>{{item.name}}</span>
                                </option>
                            </template>
                        </select>
                    </div>

                    <!-- <select id=findUserRole style="font: inherit; margin-left:0.5em;">
                        <option>Select Role</option>
                        <option value="ADMIN">Admin</option>
                        <option value="ORG_ADMIN">Organization Admin</option>
                        <option value="REGISTERED">Registered</option>
                    </select> -->

                    <!--
                    <select>
                        <option>NQF 0018 Controlling High Blood Pressure</option>
                        <option>NQF 0059 Diabetes: HbA1c Poor Control</option>
                    </select>
                    -->
                </div>
                <div class="child parent">
                    <label class="child" style="font: inherit; margin-left:0.5em;"> <b>Year:</b> </label>
                    <div class="child" style="box-shadow: 1px 1px 1px 1px lightgray; margin: 0 1em;">
                        <select id="selectYear" style="font: inherit" on-change="loadMeasureData">
                            <template is="dom-repeat" items="{{years}}">
                                <option style="font: inherit" value="{{item}}">
                                    <span>{{item}}</span>
                                </option>
                            </template>
                        </select>
                    </div>
                    <!--
                    <select>
                        <option>2015</option>
                        <option>2014</option>
                        <option>2013</option>
                        <option>2012</option>
                        <option>2011</option>
                    </select>
                    -->
                </div>
                <div class="child parent">
                    <label class="child" style="font: inherit; margin-left:0.5em;"><b>Analytics:</b></label>
                    <div class="child" style="box-shadow: 1px 1px 1px 1px lightgray; margin: 0 1em;">
                        <select value="{{selectedView::change}}" style="font: inherit;" on-change="loadMeasureData">
                            <option>Choose view..</option>
                            <option value="0">List View</option>
                            <option value="1">Measure Trend</option>
                            <option value="2">Measure Demographics</option>
                        </select>
                    </div>
                </div>
            </div>
            <div>
                <!--
                <paper-tabs selected="{{selected}}">
                    <paper-tab>List</paper-tab>
                    <paper-tab>Measure Trend</paper-tab>
                    <paper-tab>Measure Demographics</paper-tab>
                </paper-tabs>
                -->
                <iron-pages selected="{{selectedView}}">
                    <app-history-list-view></app-history-list-view>
                    <app-history-graph></app-history-graph>
                    <app-history-demographics id="histographic"></app-history-demographics>
                </iron-pages>
            </div>
        </div>
        <shape-iron-ajax-helper
          id="findMeasures"
          resource=""
          method="GET"
          handle-as="json"
          on-response="callBackMeasures"
          debounce-duration="300">
        </shape-iron-ajax-helper>
    </template>
</dom-module>
<script>
    (function () {
        Polymer({
            is: 'app-history',
            properties: {
              owner : {
                    type: String,
                    value: 'Daniel',
                    notify: true
                },
              selectMeasure : {
                Array
              }
                /*stratify: {
                    gender1: "Male",
                    gender2: "Female",
                    race1: "African American/Black",
                    race2: "American Indian or Alaska Native",
                    race3: "Asian",
                    race4: "Native Hawaiian or Pacific Islander",
                    race5: "White",
                    race6: "Other",
                    ethnicity1: "Hispanic/Latino",
                    ethnicity2: "Not Hispanic/Latino",
                    age1: "18-44 Years",
                    age2: "45-64 Years",
                    age3: "65-85 Years"
                };*/

            },

            setajaxMeasures: function () {
              this.$.findMeasures.resource = "/common/measure/findAll";
              this.$.findMeasures.callBack=this.callBackMeasures;
              this.$.findMeasures.generateRequest();
            },

            callBackMeasures: function(request) {
              this.measures=request.detail.response;
            },

            ready: function() {
                this.owner="it is here";
                this.years = [];


            },
            loadMeasureData: function() {
              document.querySelector('app-history-list-view').setajax();
              document.querySelector('app-history-graph').loadTrendChart();
              document.querySelector('app-measure-input').setAjaxMeasure();
              document.querySelector('app-profile').organizationID = this.selectedOrganization;
              document.querySelector('app-profile').setajax();

            },
            /*buildStratify: function (e) {

                console.log(stratify);
            for (i = 0; i < stratify.length; i++)
                {
                    document.write("<h1>Hello</h1>")
                    "<div class='parent'>
                        <div class='child modalSection double'>'stratify.i'</div>
                        <div class='child single'>
                            <paper-input label='Numerator'></paper-input>
                        </div>
                        <div class='child single'>
                            <paper-input label='Denominator'></paper-input>
                        </div>
                    </div>"
                }
                console.log("I'm calling the function")
            }*/
        });
    })();

</script>
